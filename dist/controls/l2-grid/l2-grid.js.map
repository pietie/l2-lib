{"version":3,"file":"l2-grid.js","sourceRoot":"","sources":["../../../L2-Lib/controls/l2-grid/l2-grid.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, Output, EventEmitter, Directive, QueryList, ContentChildren, AfterContentInit, ViewContainerRef, TemplateRef, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\nimport { Observable } from 'rxjs/Observable';\n\nimport jsDAL from '../../L2.DAL'\n\n\n@Directive({ selector: 'column' })\nexport class L2GridColumn {\n    @Input() bound: string = null;\n    @Input() display: string = null;\n\n\n}\n\r\n \nexport class L2GridTemplateColumnRow {\n    constructor(/*public $implicit: anypublic $implicit: any, public index: number, public count: number*/) {\n    }\n}\n\n@Directive({\n    selector: '[templatecolumn]', //inputs: [ 'row', 'index' ]\n    inputs: [ 'bound', 'display'],\n    providers: [{ provide: L2GridColumn, useExisting: L2GridTemplateColumn }] // 'cheat' so that  @ContentChildren(L2GridColumn) picks up this column type as well\n\n})\nexport class L2GridTemplateColumn {\n    @Input() bound: string = null;\n    @Input() display: string = null;\n\n    constructor(private templateRef: TemplateRef<L2GridTemplateColumnRow>) {\n    }\n}\n\n\n@Directive({ selector: 'columns' })\nexport class L2GridColumnCollection implements AfterContentInit {\n    @ContentChildren(L2GridColumn) columnList: QueryList<L2GridColumn>;\n\n    ngAfterContentInit() {\n    }\n}\n\n\n@Directive({ selector: 'no-results' })\nexport class L2GridNoResults {\n\n}\n\ndeclare var require:any;\n\n@Component({\n    selector: 'l2-grid',\n    template: require('./l2-grid.html'), // temporary solution until I figure out how to compile and package this project properly\n    styles: [ require('./l2-grid.css')],\n    //templateUrl: './l2-grid.html',\n    //styleUrls: ['./l2-grid.css'],\n    changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class L2Grid implements AfterContentInit {\n\n    private _dataSource: any = null;\n    private _sproc: jsDAL.Sproc;\n    private isDataBound: boolean = false;\n    private _autoExecute: boolean = true;\n    private _isLoading: boolean = false;\n    private _lastDurationInMilliseconds: number;\n\n    @Input() public showHeaderStats: boolean = false;\n    @Input() public showFooterStats: boolean = true;\n\n    get dataSource(): any { return this._dataSource; }\n\n    set isLoading(v: boolean) { this._isLoading = v; this.changeDetectorRef.markForCheck(); }\n    get isLoading(): boolean {\n        return this._isLoading;\n    }\n\n    set lastDurationInMilliseconds(val: number) { this._lastDurationInMilliseconds = val; }\n    get lastDurationInMilliseconds(): number { return this._lastDurationInMilliseconds; }\n\n    @Input() set dataSource(value: any) {\n\n        if (jsDAL.Sproc.looksLikeADuck(value)) {\n            this.sproc = value;\n        }\n        else {\n            this._dataSource = value;\n            if (value != null) this.isDataBound = true;\n\n            this.changeDetectorRef.markForCheck();\n        }\n    }\n\n    @Input() set autoExecute(value: boolean) {\n        this._autoExecute = value;\n    }\n\n    private set sproc(value: jsDAL.Sproc) {\n\n        this._sproc = value;\n        if (!this.isLoading) {\n            this.isLoading = this._sproc.isLoading;\n        }\n        this._sproc.then(r => {\n            this.lastDurationInMilliseconds = this._sproc.lastExecutionTime;\n            if (!r.Message) {\n                this._dataSource = r.Data.Table0;\n                this.isDataBound = true;\n            }\n            else {\n                this._dataSource = [];\n                this.isDataBound = true;\n            }\n            this._isLoading = false;\n\n            this.changeDetectorRef.markForCheck();\n\n        }).catch(e => {\n            this._isLoading = false;\n            throw e;\n        });\n    }\n\n    get autoExecute(): boolean {\n        return this._autoExecute;\n    }\n\n    ngOnInit() {\n        // if we source our data from a Sproc rather than static data\n        if (this._sproc) {\n            if (this.autoExecute) {\n                this._isLoading = true;\n                this._sproc.ExecQuery();\n            }\n\n        }\n    }\n\n\n\n\n    @ContentChildren(L2GridColumnCollection) columnCollections: QueryList<L2GridColumnCollection>;\n\n    constructor(private viewContainerRef: ViewContainerRef, private changeDetectorRef: ChangeDetectorRef) {\n    }\n\n\n    private getColumnNames(): string[] {\n        \n        \n        if (this.columnCollections == null) return null;\n        return this.columnCollections.first.columnList.map(c => c.display ? c.display : \"\");\n    }\n\n\n    ngAfterContentInit() {\n        if (this.columnCollections && this.columnCollections.length > 1) throw new Error(\"You may have only one <columns> element.\");\n    }\n\n    private getFieldData(col: L2GridColumn, row: any) {\n\n        var ret = row[col.bound];\n\n        if (ret === undefined) return \"\";\n        else return ret;\n    }\n}\n"]}